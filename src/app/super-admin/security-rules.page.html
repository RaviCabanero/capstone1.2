<div class="page-wrapper">
  <div class="security-rules-container">
    <!-- Page Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Security Rules</h1>
        <p>Configure and monitor system security policies.</p>
      </div>
      <div class="header-actions">
        <ion-button class="primary-btn" (click)="addNewRule()">
          <ion-icon name="add-outline" slot="start"></ion-icon>
          Add Rule
        </ion-button>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card total">
        <div class="stat-label">Total Rules</div>
        <div class="stat-value">{{ totalRulesCount }}</div>
      </div>
      <div class="stat-card enabled">
        <div class="stat-label">Enabled</div>
        <div class="stat-value">{{ enabledRulesCount }}</div>
      </div>
      <div class="stat-card disabled">
        <div class="stat-label">Disabled</div>
        <div class="stat-value">{{ disabledRulesCount }}</div>
      </div>
    </div>

    <!-- Controls -->
    <div class="section-card controls-card">
      <div class="controls-grid">
        <div class="search-wrapper">
          <ion-icon name="search-outline"></ion-icon>
          <input
            type="text"
            placeholder="Search rules by name or description..."
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()"
          />
        </div>
        <div class="filter-group">
          <label>Severity</label>
          <div class="filter-buttons">
            <button type="button" [class.active]="severityFilter === 'all'" (click)="severityFilter = 'all'; onSeverityFilterChange()">
              All
            </button>
            <button type="button" [class.active]="severityFilter === 'critical'" (click)="severityFilter = 'critical'; onSeverityFilterChange()">
              Critical
            </button>
            <button type="button" [class.active]="severityFilter === 'high'" (click)="severityFilter = 'high'; onSeverityFilterChange()">
              High
            </button>
            <button type="button" [class.active]="severityFilter === 'medium'" (click)="severityFilter = 'medium'; onSeverityFilterChange()">
              Medium
            </button>
            <button type="button" [class.active]="severityFilter === 'low'" (click)="severityFilter = 'low'; onSeverityFilterChange()">
              Low
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Rules Table -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">
          <ion-icon name="shield-checkmark-outline"></ion-icon>
          <h2>Policy Controls</h2>
        </div>
        <p class="section-subtitle">Manage rule status and severity levels</p>
      </div>

      <div class="table-wrapper" *ngIf="filteredRules.length > 0; else noRules">
        <table class="rules-table">
          <thead>
            <tr>
              <th>Rule</th>
              <th>Description</th>
              <th>Severity</th>
              <th>Status</th>
              <th class="actions-col">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let rule of filteredRules">
              <td class="rule-name">
                <div class="rule-title">{{ rule.name }}</div>
                <div class="rule-id">ID: {{ rule.id }}</div>
              </td>
              <td class="rule-desc">{{ rule.description }}</td>
              <td class="rule-severity">
                <span class="severity-badge" [class]="rule.severity">
                  {{ rule.severity }}
                </span>
              </td>
              <td class="rule-status">
                <span class="status-badge" [class.enabled]="rule.isEnabled" [class.disabled]="!rule.isEnabled">
                  <ion-icon [name]="rule.isEnabled ? 'checkmark-circle-outline' : 'close-circle-outline'"></ion-icon>
                  {{ rule.isEnabled ? 'Enabled' : 'Disabled' }}
                </span>
              </td>
              <td class="actions-cell">
                <ion-toggle
                  [(ngModel)]="rule.isEnabled"
                  (ionChange)="toggleRule(rule)"
                  [color]="rule.isEnabled ? 'success' : 'danger'"
                ></ion-toggle>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <ng-template #noRules>
        <div class="empty-state">
          <ion-icon name="shield-outline" class="empty-icon"></ion-icon>
          <h3>No security rules found</h3>
          <p>Try adjusting your search or add a new rule.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>

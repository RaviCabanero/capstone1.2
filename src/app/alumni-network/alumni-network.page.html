<!-- Top Header -->
<ion-header [translucent]="false">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="goToProfile()">
        <div class="profile-avatar-wrapper">
          <img *ngIf="userProfile?.photoDataUrl" [src]="userProfile.photoDataUrl" alt="Profile avatar" class="profile-image" />
          <div *ngIf="!userProfile?.photoDataUrl" class="profile-placeholder">
            <ion-icon name="person-circle"></ion-icon>
          </div>
        </div>
      </ion-button>
    </ion-buttons>

    <ion-searchbar
      placeholder="Search alumni..."
      mode="ios"
      class="searchbar"
      [(ngModel)]="searchQuery"
      (ionInput)="searchAlumni($event)"
      debounce="500"
      animated="true">
    </ion-searchbar>

    <ion-buttons slot="end">
      <ion-button (click)="goToMessages()">
        <ion-icon name="chatbubbles" class="chat-icon"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Invite Card Section -->
  <div class="invite-card">
    <div class="invite-text">
      <h3>Invite 3 of your alumni to connect today</h3>
    </div>
    <div class="invite-avatars">
      <div class="invite-avatar" *ngFor="let user of inviteAvatars">
        <img [src]="user.photoDataUrl || 'assets/icon/favicon.png'" [alt]="user.firstName" />
      </div>
    </div>
    <ion-button expand="block" color="light" class="search-btn" (click)="searchAlumniToInvite()">
      <ion-icon name="search" slot="start"></ion-icon>
      Search Alumni You Know
    </ion-button>
  </div>

  <!-- Network Overview Section -->
  <div class="network-overview">
    <h3 class="section-title">Network Overview</h3>
    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-value">{{ inviteSent }}</div>
        <div class="stat-label">Invite Sent</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ connections }}</div>
        <div class="stat-label">Connection</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">{{ following }}</div>
        <div class="stat-label">Following</div>
      </div>
    </div>
  </div>

  <!-- Suggested Alumni Section -->
  <div class="suggested-section">
    <!-- Department Filter -->
    <div class="department-filter">
      <ion-select
        [(ngModel)]="selectedDepartmentFilter"
        (ionChange)="onDepartmentChange()"
        interface="popover"
        placeholder="Filter by Department">
        <ion-select-option value="all">All Departments</ion-select-option>
        <ion-select-option value="my">My Department ({{ userDepartment }})</ion-select-option>
        <ion-select-option value="School of Computer Studies">School of Computer Studies</ion-select-option>
        <ion-select-option value="School of Education">School of Education</ion-select-option>
        <ion-select-option value="School of Engineering">School of Engineering</ion-select-option>
        <ion-select-option value="School of Business">School of Business</ion-select-option>
      </ion-select>
    </div>

    <h3 class="section-title" *ngIf="!isSearching">{{ selectedDepartment }}</h3>
    <h3 class="section-title" *ngIf="isSearching">
      Search Results ({{ suggestedAlumni.length }})
      <ion-button fill="clear" size="small" (click)="clearSearch()" class="clear-btn">
        Clear
      </ion-button>
    </h3>

    <div class="alumni-grid" *ngIf="suggestedAlumni.length > 0; else noAlumni">
      <div class="alumni-card-item" *ngFor="let alumnus of suggestedAlumni; let i = index" (click)="goToAlumniProfile(alumnus.id)">
        <div class="card-dismiss" (click)="$event.stopPropagation()">
          <ion-button fill="clear" size="small" (click)="dismissAlumnus(i)">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </div>

        <div class="card-avatar">
          <img [src]="alumnus.photoDataUrl || 'assets/icon/favicon.png'" [alt]="alumnus.firstName" />
        </div>

        <div class="card-info">
          <h4 class="alumni-name">{{ alumnus.firstName }} {{ alumnus.lastName }}</h4>
          <p class="alumni-major">{{ alumnus.course || 'Course not specified' }}</p>
          <p class="alumni-department">{{ alumnus.schoolDepartment || alumnus.department || 'No department' }}</p>
        </div>

        <ion-button expand="block" color="success" size="small" (click)="$event.stopPropagation(); connectWithAlumnus(alumnus.id)">
          Connect
        </ion-button>
      </div>
    </div>

    <div class="show-all-container" *ngIf="suggestedAlumni.length > 0 && !isSearching">
      <ion-button fill="clear" expand="block" (click)="showAllAlumni()">
        Show all
      </ion-button>
    </div>

    <ng-template #noAlumni>
      <div class="empty-state">
        <ion-icon name="people-outline"></ion-icon>
        <p *ngIf="!isSearching">No other alumni found in {{ userDepartment }}</p>
        <p *ngIf="isSearching">No users found matching "{{ searchQuery }}"</p>
        <small *ngIf="!isSearching">Check the browser console for debugging info</small>
      </div>
    </ng-template>
  </div>
</ion-content>

<!-- Bottom Tab Bar -->
<ion-footer>
  <ion-tab-bar slot="bottom" class="custom-tab-bar">
    <ion-tab-button tab="home" routerLink="/home">
      <ion-icon name="home"></ion-icon>
      <ion-label>Home</ion-label>
    </ion-tab-button>
    
    <ion-tab-button tab="alumni" routerLink="/alumni-network">
      <ion-icon name="people"></ion-icon>
      <ion-label>Alumni</ion-label>
    </ion-tab-button>
    
    <ion-tab-button tab="post" (click)="openPostModal()">
      <ion-icon name="add-circle"></ion-icon>
      <ion-label>Post</ion-label>
    </ion-tab-button>
    
    <ion-tab-button tab="notification" routerLink="/notifications">
      <ion-icon name="notifications"></ion-icon>
      <ion-label>Notification</ion-label>
      <ion-badge *ngIf="notificationCount > 0">{{ notificationCount }}</ion-badge>
    </ion-tab-button>
    
    <ion-tab-button tab="menu" (click)="openMenu()">
      <ion-icon name="menu"></ion-icon>
      <ion-label>Menu</ion-label>
    </ion-tab-button>
  </ion-tab-bar>
</ion-footer>


<ion-header>
  <ion-toolbar color="danger">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/alumni-admin"></ion-back-button>
    </ion-buttons>
    <ion-title>Alumni Directory</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar 
      [(ngModel)]="searchTerm" 
      (ionInput)="searchAlumni()"
      placeholder="Search by name, role, status, department, address, or email"
      animated="true">
    </ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="page-header">
  <h2>{{ isDeptHead ? 'Department Alumni' : 'Complete Alumni List' }}</h2>
  <p>{{ filteredAlumni.length }} registered users</p>
</div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <ion-spinner name="crescent" color="danger"></ion-spinner>
    <p>Loading alumni directory...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && filteredAlumni.length === 0" class="empty-state">
    <ion-icon name="search-outline" color="medium"></ion-icon>
    <h3>No Alumni Found</h3>
    <p *ngIf="searchTerm">Try adjusting your search criteria</p>
    <p *ngIf="!searchTerm">No registered users in the system yet</p>
  </div>

  <!-- Alumni List (Table) -->
  <div *ngIf="!loading && filteredAlumni.length > 0" class="table-wrapper">
    <div class="table-header">
      <div class="col name">First Name</div>
      <div class="col name">Last Name</div>
      <div class="col role">Role</div>
      <div class="col dept">Department</div>
      <div class="col course">Course</div>
      <div class="col status">Status</div>
      <div class="col year">Year Graduated</div>
      <div class="col email">Email</div>
      <div class="col birthdate">Birthdate</div>
      <div class="col mobile">Mobile</div>
      <div class="col address">Address</div>
      <div class="col province">Province</div>
      <div class="col action">Assign Role</div>
    </div>

    <div class="table-row" *ngFor="let alumni of filteredAlumni">
      <div class="col name">{{ alumni.firstName || 'N/A' }}</div>
      <div class="col name">{{ alumni.lastName || 'N/A' }}</div>
      <div class="col role">
        <ion-chip color="primary" class="role-chip">
          <ion-label>{{ formatRole(alumni.role) }}</ion-label>
        </ion-chip>
      </div>
      <div class="col dept">{{ getDepartment(alumni) }}</div>
      <div class="col course">{{ alumni.course || 'N/A' }}</div>
      <div class="col status">
        <ion-chip [color]="alumni.status === 'approved' ? 'success' : (alumni.status === 'pending' ? 'warning' : 'medium')">
          <ion-label>{{ alumni.status || 'unknown' }}</ion-label>
        </ion-chip>
      </div>
      <div class="col year">{{ alumni.yearGraduated || 'N/A' }}</div>
      <div class="col email">{{ maskEmail(alumni.email) }}</div>
      <div class="col birthdate">{{ formatDate(alumni.birthdate) }}</div>
      <div class="col mobile">{{ alumni.phone || 'N/A' }}</div>
      <div class="col address">{{ alumni.address || 'N/A' }}</div>
      <div class="col province">{{ alumni.province || 'N/A' }}</div>
      <div class="col action">
        <ion-select
          interface="popover"
          [value]="alumni.role || 'alumni'"
          (ionChange)="assignRole(alumni, $event.detail.value)">
          <ion-select-option value="alumni">Alumni</ion-select-option>
          <ion-select-option value="dept_head">Dept Head</ion-select-option>
        </ion-select>
      </div>
    </div>
  </div>
</ion-content>
